# OpenSearch connection
OPENSEARCH_HOST=https://localhost:9200
OPENSEARCH_USER=admin
OPENSEARCH_PASSWORD=admin
# SSL certificate verification - enabled by default for security
# Set to false only for development with self-signed certificates
# OPENSEARCH_VERIFY_CERTS=true

# Index prefix - all user-created indices will be prefixed with this
INDEX_PREFIX=shipit-

# Index protection - block writes to indices not created by ShipIt. Enabled by default.
# STRICT_INDEX_MODE=false

# How long to keep failed record files (in hours)
FAILURE_FILE_RETENTION_HOURS=24

# Maximum file upload size in MB (supports up to 5GB with chunked upload)
MAX_FILE_SIZE_MB=5000

# Chunked upload settings - files over 100MB use chunked upload automatically
# CHUNK_SIZE_MB=10
# CHUNK_RETENTION_HOURS=24

# Maximum fields per document - prevents OpenSearch mapping explosion
# Set to 0 to disable limit
# MAX_FIELDS_PER_DOCUMENT=1000

# Rate limiting - uploads per minute per user (by user ID or IP for anonymous)
# Set to 0 to disable rate limiting
# UPLOAD_RATE_LIMIT_PER_MINUTE=10

# Index retention - automatically delete indices older than X days
# Set to 0 to disable automatic deletion (default)
# INDEX_RETENTION_DAYS=0

# Bulk batch size - number of records per bulk insert to OpenSearch
# BULK_BATCH_SIZE=1000

# Environment - set to "production" in production deployments
# When SHIPIT_ENV=production, SESSION_SECRET must be changed from default
# SHIPIT_ENV=development

# Session
SESSION_SECRET=change-me-in-production
SESSION_DURATION_HOURS=8

# Login security
# Rate limit login attempts per IP per minute
# LOGIN_RATE_LIMIT_PER_MINUTE=5
# Account lockout after failed attempts
# ACCOUNT_LOCKOUT_ATTEMPTS=5
# ACCOUNT_LOCKOUT_MINUTES=15

# Password complexity requirements
# PASSWORD_MIN_LENGTH=8
# PASSWORD_REQUIRE_UPPERCASE=true
# PASSWORD_REQUIRE_LOWERCASE=true
# PASSWORD_REQUIRE_DIGIT=true
# PASSWORD_REQUIRE_SPECIAL=false

# Trusted proxies - CIDR ranges for X-Forwarded-For header trust
# Only trust X-Forwarded-For from these IP ranges (prevents IP spoofing)
# Example: TRUSTED_PROXIES=["10.0.0.0/8", "172.16.0.0/12"]
# TRUSTED_PROXIES=[]

# GeoIP enrichment (optional) - MaxMind GeoLite2 license key
# Sign up at https://www.maxmind.com/en/geolite2/signup
# Database is auto-downloaded on startup when license key is set
# MAXMIND_LICENSE_KEY=your-license-key
# GEOIP_AUTO_UPDATE_DAYS=7  # Auto-update interval (0 to disable)

# App URL - used for CORS and OIDC callback URL
# Required for production deployments behind proxy/DNS
# APP_URL=https://shipit.example.com

# OIDC (optional - for SSO authentication)
# Set OIDC_ENABLED=true and configure your IdP with callback URL: {APP_URL}/api/auth/callback
# OIDC_ENABLED=false
# OIDC_ISSUER_URL=https://your-idp.example.com
# OIDC_CLIENT_ID=your-client-id
# OIDC_CLIENT_SECRET=your-client-secret
# OIDC_ALLOWED_DOMAIN=yourcompany.com
# Role mapping from OIDC groups (priority: admin > user > viewer):
# - Admin group members get full admin access
# - User group members can upload, configure, delete
# - Viewer group members get read-only access (can view history/audit logs)
# If USER_GROUPS or VIEWER_GROUPS are configured, users not in any group are denied access.
# If neither is configured, all authenticated users get "user" role (backward compatible).
# OIDC_ADMIN_GROUP=shipit-admins
# OIDC_USER_GROUPS=["shipit-users"]
# OIDC_VIEWER_GROUPS=["shipit-auditors"]

# Logging - set to debug for detailed diagnostic output
# LOG_LEVEL=info  # debug, info, warning, error

# Audit log shipping (optional)
# Ship audit logs to OpenSearch (creates {INDEX_PREFIX}audit-logs index)
# AUDIT_LOG_TO_OPENSEARCH=false
# Ship audit logs to external HTTP endpoint (e.g., SIEM)
# AUDIT_LOG_ENDPOINT=https://siem.company.com/api/logs
# AUDIT_LOG_ENDPOINT_TOKEN=secret-bearer-token
# AUDIT_LOG_ENDPOINT_HEADERS=X-Custom-Header:value,X-Another:value2

# AI-assisted ECS mapping (optional)
# Uses OpenAI to suggest ECS field mappings for log fields
# Get an API key at https://platform.openai.com/api-keys
# OPENAI_API_KEY=sk-your-api-key
# OPENAI_MODEL=gpt-4o-mini  # Default model, can use gpt-4o for better accuracy
